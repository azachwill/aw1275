<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-12-02">
<meta name="description" content="A lot of work went into adding new features to gt (and enhancing what was already there). The v0.8.0 release of gt is quite exciting so we want to show you all the things you can now do when making tables!">

<title>New Features and Serious Upgrades in {gt} 0.8.0</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
</style>


<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">


</head>

<body>


<header id="title-block-header">
<h1 class="title">New Features and Serious Upgrades in {gt} 0.8.0</h1>

<p class="date">2022-12-02</p>
</header>

<p>The <strong>gt</strong> package helps us create tables for publication and its development as of late has been quite swift! We’re pleased to share all the improvements in the newest release of <strong>gt</strong>: version <code>0.8.0</code>. There’s <em>a lot</em> to talk about here. We will start by introducing all 14 new functions in this release. After that, we’ll discuss improvements to existing functions and rendered outputs. We can’t go through everything that’s changed (it’s just way too much) but what’s outlined here constitutes the top-tier changes.</p>
<h2 class="anchored">
<code>sub_values()</code>: Substituting Targeted Values in the Table Body
</h2>
<p>The new function <code>sub_values()</code> is here for substituting values in body cells with replacement text. The targeting of cells can be based on literal values, a regex pattern, or a specialized function of your own devising. This is best explained through examples so let’s start by creating an input table with three columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tbl <span class="ot">&lt;-</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_1 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.01</span>, <span class="dv">74</span>, <span class="cn">NA</span>, <span class="dv">0</span>, <span class="dv">500</span>, <span class="fl">0.001</span>, <span class="fl">84.3</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">int_1 =</span> <span class="fu">c</span>(1L, <span class="sc">-</span>100000L, 800L, 5L, <span class="cn">NA</span>, 1L, <span class="sc">-</span>32L),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">lett =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
    num_1   int_1 lett 
    &lt;dbl&gt;   &lt;int&gt; &lt;chr&gt;
1  -0.01        1 A    
2  74     -100000 B    
3  NA         800 C    
4   0           5 D    
5 500          NA E    
6   0.001       1 F    
7  84.3       -32 G    </code></pre>
</div>
</div>
<p>Values in the table body cells can be replaced by specifying which values should be replaced (in <code>values</code>) and what the replacement value should be. It’s okay to search for numerical or character values across all columns. It’s also fine whether the replacement value is of the numeric or character type.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tbl <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_values</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">74</span>, <span class="dv">500</span>), <span class="at">replacement =</span> <span class="dv">150</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_values</span>(<span class="at">values =</span> <span class="st">"B"</span>, <span class="at">replacement =</span> <span class="st">"Bee"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_values</span>(<span class="at">values =</span> <span class="dv">800</span>, <span class="at">replacement =</span> <span class="st">"Eight hundred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="sub-values-1.png" class="img-fluid" alt="Output table for example that uses `sub_values()` exclusively with the `value` argument." width="1230"></p>
</div>
</div>
<p>We can also use the <code>pattern</code> argument to target cell values for replacement in <code>character</code>-based columns.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tbl <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_values</span>(<span class="at">pattern =</span> <span class="st">"A|C|E"</span>, <span class="at">replacement =</span> <span class="st">"Ace"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="sub-values-2.png" class="img-fluid" alt="Output table for example that uses `sub_values()` exclusively with the `pattern` argument." width="1230"></p>
</div>
</div>
<p>For the most flexibility, it’s probably best to use the <code>fn</code> argument. With that you need to provide a function that returns logical values.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tbl <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sub_values</span>(<span class="at">fn =</span> <span class="cf">function</span>(x) x <span class="sc">&lt;</span> <span class="dv">50</span>, <span class="at">replacement =</span> <span class="st">"Under 50"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="sub-values-3.png" class="img-fluid" alt="Output table for example that uses `sub_values()` exclusively with the `fn` argument." width="1230"></p>
</div>
</div>
<h2 class="anchored">
Styling Targeted Values in the Table Body with <code>tab_style_body()</code>
</h2>
<p>We want the setting of styles to be as easy as possible so, to that end, we’ve added a helpful new function: <code>tab_style_body()</code>. This function is a bit like <code>sub_values()</code> and a bit like <code>tab_style()</code>. The idea is that basic style attributes can be set based on values in the table body. We can target body cells through value, regex, and custom matching rules, and, apply styles to them and their surrounding context (e.g., styling an entire row or column wherein the match is found). As before, we need examples to really understand what this function can do.</p>
<p>We’ll begin by creating a simple <strong>gt</strong> table with a stub and row groups. This contains an assortment of values that could potentially undergo some styling via <code>tab_style_body()</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="ot">&lt;-</span> <span class="fu">gt</span>(exibble, <span class="at">rowname_col =</span> <span class="st">"row"</span>, <span class="at">groupname_col =</span> <span class="st">"group"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>gt_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="exibble-gt-table.png" class="img-fluid" alt="A gt table with a stub and row groups; generated by using the `gt()` function with the `exibble` dataset." width="1234"></p>
</div>
</div>
<p>Cells in the table body can be styled through specification of literal values in the values argument of <code>tab_style_body()</code>. It’s okay to search for numerical, character, or logical values across all columns. Let’s target the values <code>49.95</code> and <code>33.33</code> and style those cells with an orange fill.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style_body</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"orange"</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="fl">49.95</span>, <span class="fl">33.33</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="tab-style-body-1.png" class="img-fluid" alt="Output table for example that uses `tab_style_body()` exclusively with the `value` argument." width="1230"></p>
</div>
</div>
<p>Multiple styles can be combined in a <code>list</code>, here’s an example of that using the same cell targets:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style_body</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">font =</span> <span class="fu">google_font</span>(<span class="st">"Dancing Script"</span>), <span class="at">color =</span> <span class="st">"white"</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"red"</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_borders</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">sides =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"right"</span>),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">weight =</span> <span class="fu">px</span>(<span class="dv">4</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="fl">49.95</span>, <span class="fl">33.33</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="tab-style-body-2.png" class="img-fluid" alt="Output table for example that uses `tab_style_body()` exclusively with the `value` argument; multiple styles are used by enclosing them in a `list()`." width="1230"></p>
</div>
</div>
<p>Entire rows or columns can be styled by using specific keywords in the <code>targets</code> argument. For the <code>49.95</code> value we will style the entire row and with <code>33.33</code> the entire column will get the same styling.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style_body</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightgreen"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fl">49.95</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">targets =</span> <span class="st">"row"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style_body</span>(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightgreen"</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fl">33.33</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">targets =</span> <span class="st">"column"</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="tab-style-body-3.png" class="img-fluid" alt="Output table for example that uses `tab_style_body()` twice with the `value` argument. The `targets` argument is used to expand the styling to neighboring body cells." width="1230"></p>
</div>
</div>
<p>In a minor variation to the prior example, it’s possible to extend the styling to other locations, or, entirely project the styling elsewhere. This is done with the <code>extents</code> argument. Valid keywords that can be included in the vector are: <code>"body"</code> (the default) and <code>"stub"</code>. Let’s take the previous example and extend the styling of the row into the stub.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style_body</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightgreen"</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fl">49.95</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">targets =</span> <span class="st">"row"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">extents =</span> <span class="fu">c</span>(<span class="st">"body"</span>, <span class="st">"stub"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style_body</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightgreen"</span>),</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fl">33.33</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">targets =</span> <span class="st">"column"</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="tab-style-body-4.png" class="img-fluid" alt="Output table for example that uses `tab_style_body()` twice with the `value` argument. The `targets` argument is used to expand the styling to neighboring body cells and `extents` is used to further project the styling" width="1230"></p>
</div>
</div>
<p>We can also use the pattern argument to target cell values in <code>character</code>-based columns. The <code>"fctr"</code> column is skipped because it is in fact a factor-based column.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style_body</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pattern =</span> <span class="st">"ne|na"</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="tab-style-body-5.png" class="img-fluid" alt="Output table for example that uses `tab_style_body()` exclusively with the `pattern` argument." width="1230"></p>
</div>
</div>
<p>For the most flexibility in targeting, it’s best to use the <code>fn</code> argument. The function you give to <code>fn</code> will be invoked separately on all cells so the columns argument of <code>tab_style_body()</code> might be useful to limit which cells should be evaluated. For this next example, the supplied function should only be used on numeric values and we can make sure of this by using <code>columns = where(is.numeric)</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style_body</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">where</span>(is.numeric),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"pink"</span>),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> <span class="cf">function</span>(x) x <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> x <span class="sc">&lt;</span> <span class="dv">50</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="tab-style-body-6.png" class="img-fluid" alt="Output table for example that uses `tab_style_body()` exclusively with the `fn` argument." width="1230"></p>
</div>
</div>
<h2 class="anchored">
Cellular Extraction with <code>extract_cells()</code>
</h2>
<p>Replicating summary table values in a paragraph of text within an R Markdown or Quarto document typically involves non-optimal solutions including manual transcription or obtaining values from the input table and formatting that value. With the new <code>extract_cells()</code> function, we can extract a vector of body cell values from a <code>gt_tbl</code> object. The output vector will have the cell data formatted in the same way as in the table.</p>
<p>Here’s a minimal R Markdown document with a nicely formatted table that uses the <code>sp500</code> dataset. That table object is assigned to <code>tbl</code> and is used in two instances of inline code (with <code>r</code>) that calls <code>extract_cells()</code> (pulling a single value in both cases).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>output: html_document</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>```{r echo=FALSE}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>library(gt)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>library(dplyr)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>tbl &lt;-</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  sp500 %&gt;%</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  dplyr::filter(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    date &gt;= "1970-06-01" &amp;</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    date &lt;= "1970-06-30"</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  ) %&gt;%</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  dplyr::select(-adj_close) %&gt;%</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  dplyr::mutate(date = as.character(date)) %&gt;%</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  dplyr::mutate(dow = date) %&gt;%</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  dplyr::arrange(date) %&gt;%</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  gt(rowname_col = "date") %&gt;%</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  cols_move_to_start(columns = dow) %&gt;%</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  fmt_datetime(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    columns = dow,</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    format = "EEEEEE"</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  ) %&gt;%</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  cols_merge(</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    columns = c(date, dow),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    pattern = "{1} ({2})"</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  ) %&gt;%</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  fmt_currency(</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    columns = c(open, high, low, close),</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    currency = "USD"</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  ) %&gt;%</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  fmt_number(</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    columns = volume,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    suffixing = TRUE</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>  ) %&gt;%</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  cols_label(</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    date = "Date", open = "Open", high = "High",</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    low = "Low", close = "Close", volume = "Volume"</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>  ) %&gt;%</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  opt_vertical_padding(scale = 0.35) %&gt;%</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  tab_options(table.font.size = px(12))</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>tbl</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>On the 15th of June, 1970 (a `r vec_fmt_datetime("1970-06-15", format = "EEEE")`), the S&amp;P 500 closed at a value of `r extract_cells(tbl, close, "1970-06-15")` with a volume of `r extract_cells(tbl, volume, "1970-06-15")` (the lowest that month).</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The rendered document below gives us exactly what we need since the inline code statements get the correctly formatted text for the paragraph (and without any worry of reproducibility problems):</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="sp500-rmarkdown-html.png" class="img-fluid" alt="Screen capture of rendered R Markdown document showing a gt table and a paragraph pieced together with inline code featuring `extract_cells()`." width="1250"></p>
</div>
</div>
<p>The bonus usage of <code>vec_fmt_datetime()</code> in the first inline code statement utilizes new date and time formatting capabilities. This will be discussed in a later section of this post.</p>
<h2 class="anchored">
Decimal Alignment for Numerical Values in a Column
</h2>
<p>We can now have decimal alignment for numeric values and this is made possible with the new <code>cols_align_decimal()</code> function. The function ensures that columns targeted are right-aligned, that accounting notation is supported, footnote marks don’t interfere, and whole numbers align correctly.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">char =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>],</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">num =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="sc">-</span><span class="fl">33.52</span>, <span class="fl">9023.2</span>, <span class="sc">-</span><span class="fl">283.527</span>, <span class="cn">NA</span>, <span class="fl">0.401</span>, <span class="sc">-</span><span class="fl">123.1</span>, <span class="cn">NA</span>, <span class="dv">41</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> num,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">drop_trailing_zeros =</span> <span class="cn">TRUE</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align_decimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="cols-align-decimal.png" class="img-fluid" alt="Output table for example that uses `cols_align_decimal()` to perform decimal alignment in the `num` column." width="1230"></p>
</div>
</div>
<p>For now, this function only works adequately for HTML table output. We’ll be working to ensure that <code>cols_align_decimal()</code> will operate with all other output formats in a future release.</p>
<h2 class="anchored">
Getting a Table with Information About Your Table (So Meta!)
</h2>
<p>If you find yourself not knowing the ID values of certain cells in the table (sometimes necessary for adding footnotes, styles, etc.) the new <code>tab_info()</code> function can help. Here’s an example where a small table is generated from the <code>gtcars</code> dataset.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="ot">&lt;-</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  gtcars <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(model, year, <span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"hp"</span>, <span class="st">"mpg"</span>)))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">rowname_col =</span> <span class="st">"model"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"performance"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="fu">c</span>(<span class="st">"hp"</span>, <span class="st">"mpg"</span>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_merge</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"hp"</span>), <span class="at">pattern =</span> <span class="st">"{1} ({2})"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_merge</span>(<span class="at">columns =</span> <span class="fu">starts_with</span>(<span class="st">"mpg"</span>), <span class="at">pattern =</span> <span class="st">"{1} city / {2} hwy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">year =</span> <span class="fu">md</span>(<span class="st">"*YR*"</span>), <span class="at">hp =</span> <span class="st">"HP"</span>, <span class="at">mpg_c =</span> <span class="st">"MPG"</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>gt_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gtcars-gt-table.png" class="img-fluid" alt="Output table for example that uses an except of the `gtcars` dataset." width="1230"></p>
</div>
</div>
<p>You might receive this table and not know the <code>id</code> value or column number for the <code>mpg_c</code> column (it has the <code>"MPG"</code> label now). Through use of <code>tab_info()</code> we can get an informative table that summarizes all of the table’s ID values, their indices, and their associated labels.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tab_info</span>(gt_tbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gtcars-tab-info.png" class="img-fluid" alt="Output table obtained when using the `tab_info()` function with a `gt_tbl` object." width="1230"></p>
</div>
</div>
<p>With this information at hand we see that the column with the <code>"MPG"</code> label has the <code>mpg_c</code> ID value. Knowing this, we could successfully use <code>tab_style()</code> to style the body cells below that column. Like this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gt_tbl <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_fill</span>(<span class="at">color =</span> <span class="st">"lightblue"</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns =</span> mpg_c)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gtcars-gt-table-styled.png" class="img-fluid" alt="Output table for example that uses an except of the `gtcars` dataset, styled with knowledge of column ID value." width="1230"></p>
</div>
</div>
<p>We intend to continuously improve this function in later versions of <strong>gt</strong> so you’ll have even more useful information when you need it.</p>
<h2 class="anchored">
Safe Removals of Table Components (the <code>rm_*()</code> Family)
</h2>
<p>Much of <strong>gt</strong> is about adding things to a table but what about doing the opposite (taking things away)? The new family of <code>rm_*()</code> functions (<code>rm_header()</code>, <code>rm_stubhead()</code>, <code>rm_spanners()</code>, <code>rm_footnotes()</code>, <code>rm_source_notes()</code>, and <code>rm_caption()</code>) let us safely remove parts of a <strong>gt</strong> table. This can be advantageous in those instances where one might obtain a <strong>gt</strong> table through other means (perhaps from another package that produces <strong>gt</strong> tables?) but would prefer to excise some parts of it.</p>
<p>For example, the <a href="https://github.com/ddsjoberg/gtsummary"><strong>gtsummary</strong> package</a> is built on <strong>gt</strong> and can generate summary tables that are coercible to the <code>gt_tbl</code> class. Let’s make a summary statistics table with the <code>trial</code> dataset in <strong>gtsummary</strong>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>summary_tbl <span class="ot">&lt;-</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  trial <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_continuous</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> age,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> trt, <span class="at">include =</span> grade</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_overall</span>(<span class="at">last =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>summary_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gtsummary-tbl.png" class="img-fluid" alt="Output table for example that uses the gtsummmary package to make a summary table." width="1230"></p>
</div>
</div>
<p>If we don’t want any of the included footnotes, we can transform the <strong>gtsummary</strong> table to a <strong>gt</strong> one, and then perform the removal with <code>rm_footnotes()</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>summary_tbl <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm_footnotes</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="gtsummary-tbl-no-footnotes.png" class="img-fluid" alt="Output table for example that uses the gtsummmary package to make a summary table; we then transform it to a gt table and then remove the footnotes with the `rm_footnotes()` function." width="1228"></p>
</div>
</div>
<p>With those footnotes gone, we are free to add our own custom footnotes (since we now have a <code>gt_tbl</code> object) or just carry on with a more minimal table.</p>
<h2 class="anchored">
<code>tab_caption()</code>: Another Way to Add (or Edit) a Table Caption
</h2>
<p>We can easily add a caption to a <strong>gt</strong> table (or replace an existing one) with the new and convenient <code>tab_caption()</code> function. You might not have known that it was possible before to add a caption (the other option is through the <code>gt()</code> function’s <code>caption</code> argument). The new function makes this capability more obvious, and makes the caption editable in cases where you receive a <strong>gt</strong> table as output.</p>
<p>Here’s an example of how to use <code>tab_caption()</code> in a table built with some of the <code>gtcars</code> dataset.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gtcars <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mfr, model, msrp) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"Data listing from **gtcars**"</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">md</span>(<span class="st">"`gtcars` is an R dataset"</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_caption</span>(<span class="at">caption =</span> <span class="fu">md</span>(<span class="st">"**gt** table example."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="tab-caption-example.png" class="img-fluid" alt="Output table for example that uses the `tab_caption()` function." width="1232"></p>
</div>
</div>
<h2 class="anchored">
Making Your Numerals Roman
</h2>
<p>The new formatter function <code>fmt_roman()</code> lets us easily format numbers to Roman numerals (either as uppercase or lowercase letters). The <code>vec_fmt_roman()</code> vector-formatting function was also introduced here as all <code>fmt_*()</code> functions get a matching <code>vec_fmt_*()</code> analogue. Let’s see how this works with a practical example.</p>
<p>We could have a numerical label in the table stub and format those numbers to (lowercase) Roman numerals. We could also use the <code>pattern</code> argument to combine the formatted value with template text. Here’s how that looks in code and rendered as an HTML table:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">part =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">2.3</span>, <span class="fl">6.3</span>, <span class="fl">1.7</span>, <span class="fl">0.2</span>, <span class="fl">7.9</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">rowname_col =</span> <span class="st">"part"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_roman</span>(<span class="at">columns =</span> <span class="fu">stub</span>(), <span class="at">case =</span> <span class="st">"lower"</span>, <span class="at">pattern =</span> <span class="st">"part {x}."</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"left"</span>, <span class="at">columns =</span> <span class="fu">stub</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="cell-output-display">
<p><img src="fmt-roman-output-table.png" class="img-fluid" alt="Output table for example that uses the `fmt_roman()` function." width="1232"></p>
</div>
</div>
<p>There’s a few other things at play here. New in <code>v0.8.0</code> is the <code>stub()</code> helper function, allowing for easier targeting of the stub column. Also new is the ability to use a <code>fmt_*()</code> function on a stub column, and, <code>cols_align()</code> on a stub column is now allowed.</p>
<h2 class="anchored">
Improvements to Date and Time Formatting
</h2>
<p>The <code>fmt_date()</code> and <code>fmt_time()</code> functions (used to format dates and times) now have many more date and time styles. Dates and times can be translated to different spoken languages and the new <code>locale</code> argument has been added to these functions to provide localization control. These improvements also apply to the <code>vec_fmt_date()</code> and <code>vec_fmt_time()</code> vector-formatting variants, so let’s use those for two examples.</p>
<p>Let’s define a string-based datetime value. This is acceptable input for all date/time formatting functions so long as ISO-8601 formatting is used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>str_dt <span class="ot">&lt;-</span> <span class="st">"2018-07-04 22:05"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use <code>date_style</code> and <code>time_style</code> keywords with <code>vec_fmt_date()</code> and <code>vec_fmt_time()</code>, respectively, to easily format to a date or time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vec_fmt_date</span>(str_dt, <span class="at">date_style =</span> <span class="st">"wday_month_day_year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Wednesday, July 4, 2018"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vec_fmt_time</span>(str_dt, <span class="at">time_style =</span> <span class="st">"h_m_p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "10:05 PM"</code></pre>
</div>
</div>
<p>There are now 41 different date formatting styles and 25 different time formatting styles. Many of these styles are flexible, meaning that the structure of the format will adapt to different locales. We can always use <code>info_date_style()</code> or <code>info_time_style()</code> to call up info tables that serve as handy references to all of the <code>date_style</code> and <code>time_style</code> options.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="date-time-formats.png" class="img-fluid" alt="Side by side outputs from the `info_date_style()` and  `info_time_style()` functions." width="1352"></p>
</div>
</div>
<p>The <code>fmt_datetime()</code> and <code>vec_fmt_datetime()</code> functions allow the use of date and time styles to generate a formatted datetime. Let’s use the <code>"yMMMEd"</code> date style and <code>"hms"</code> time style (both flexible) to generate a datetime string with <code>vec_fmt_datetime()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vec_fmt_datetime</span>(str_dt, <span class="at">date_style =</span> <span class="st">"yMMMEd"</span>, <span class="at">time_style =</span> <span class="st">"hms"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Wed, Jul 4, 2018 10:05:00 PM"</code></pre>
</div>
</div>
<p>Let’s perform the same type of formatting in the French (<code>"fr"</code>) locale:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vec_fmt_datetime</span>(str_dt, <span class="at">date_style =</span> <span class="st">"yMMMd"</span>, <span class="at">time_style =</span> <span class="st">"hms"</span>, <span class="at">locale =</span> <span class="st">"fr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "4 juil. 2018 10:05:00 PM"</code></pre>
</div>
</div>
<p>Aside from the translated month name, notice that the date formatting here with <code>"yMMMd"</code> automatically conformed to the French locale by putting the day number at the front and adjusting punctuation (this is what is meant by the ‘flexible’ terminology).</p>
<p>Unlike the specialized date and time formatting functions, <code>fmt_datetime()</code> and <code>vec_fmt_datetime()</code> also include the <code>format</code> argument so anyone can provide a <code>strptime</code> format to get the formatting just right. New in <code>v0.8.0</code> is the ability to provide a CLDR (<em>Common Locale Data Repository</em>, a Unicode project) datetime pattern to <code>format</code>, allowing for even more highly customized output that is locale-aware. Let’s demonstrate this with <code>vec_fmt_datetime()</code> (the vector formatting version of <code>fmt_datetime()</code> which gets all of the same enhancements).</p>
<p>Using the same datetime value of <code>"2018-07-04 22:05"</code>, let’s use the CLDR pattern of <code>"EEEE, MMMM d, y, h:mm a"</code> to get a formatted datetime:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vec_fmt_datetime</span>(str_dt, <span class="at">format =</span> <span class="st">"EEEE, MMMM d, y, h:mm a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Wednesday, July 4, 2018, 10:05 PM"</code></pre>
</div>
</div>
<p>By using the <code>locale</code> argument, this can be formatted as a Dutch datetime value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vec_fmt_datetime</span>(str_dt, <span class="at">format =</span> <span class="st">"EEEE, MMMM d, y, h:mm a"</span>, <span class="at">locale =</span> <span class="st">"nl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "woensdag, juli 4, 2018, 10:05 p.m."</code></pre>
</div>
</div>
<p>Learning about CLDR datetime formatting can be difficult at first but the help articles for <a href="https://gt.rstudio.com/reference/fmt_datetime.html"><code>fmt_datetime()</code></a> and <a href="https://gt.rstudio.com/reference/vec_fmt_datetime.html"><code>vec_fmt_datetime()</code></a> have been completely overhauled and the updated documentation goes at length to explain the new formatting functionality.</p>
<h2 class="anchored">
Improvements to HTML Outputs
</h2>
<p>The <code>as_raw_html()</code> function is useful for generating an HTML string for table-in-HTML-email situations (i.e., using the <strong><a href="https://pkgs.rstudio.com/blastula/">blastula</a></strong> package) and for HTML embedding purposes. By default, the function performs CSS-inlining to make those use cases more robust and while this was mostly fine prior to <code>v0.8.0</code>, it had two major problems: (1) it was <em>slow</em>, and (2) the underlying R code couldn’t always keep up with changes to our SCSS styles, resulting in incorrect HTML output.</p>
<p>This is now solved by integrating the <strong><a href="https://rich-iannone.github.io/juicyjuice/">juicyjuice</a></strong> package into <code>as_raw_html()</code>. That package uses the <em>juice</em> JS library for a far more performant and correct CSS-inlining solution.</p>
<p>While we’re talking about HTML output, tables now have some padding (and a way to control the values through <code>tab_options()</code>). Tables in rendered HTML documents produced by R Markdown and Quarto used to be <em>way</em> too close to adjacent paragraphs of text. But now there is a comfortable amount of space.</p>
<h2 class="anchored">
Color Contrast Improvements in <code>data_color()</code>
</h2>
<p>The <code>data_color()</code> function allows us to color the background of cells based on data, and <strong>gt</strong> smartly chooses a text color that tries to provide the most contrast between text and background. We wanted to improve that feature so now <code>data_color()</code> has a <code>contrast_algo</code> argument that allows us to choose between two color contrast algorithms: <code>"apca"</code> (<em>Accessible Perceptual Contrast Algorithm</em>, the default algo) and <code>"wcag"</code> (<em>Web Content Accessibility Guidelines</em>). Here is an excerpt of a table (code and complete output of table is available at <a href="https://gist.github.com/rich-iannone/55ffa2cf293313e70468ca8447dd3d97">this GitHub gist</a>) that compares the two color contrast algorithms used in <code>data_color()</code>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="color-contrast-computation-comparison.png" class="img-fluid" alt="Output table for example that uses the `fmt_roman()` function." width="1232"></p>
</div>
</div>
<p>With darker backgrounds (somewhere in the midrange), the APCA algorithm tends to favor light text in the foreground. This can be seen in the table excerpt with the X11 colors <code>"antiquewhite4"</code>,<code>"aquamarine4"</code>, and <code>"azure4"</code>; all of these have light text with APCA whereas WCAG uses dark text. We believe that the APCA algorithm is the better choice but we also included the widely-used WCAG here so that you have options.</p>
<h2 class="anchored">
More Accessibility Enhancements for HTML Table Outputs
</h2>
<p>HTML tables as produced by <strong>gt</strong> can be structurally complex. One can include row groups, column spanners, summary sections, and more. We did some work in <code>v0.7.0</code> to make screen readers (applications that allow blind or visually impaired users to read the text that is displayed on the computer screen) better parse certain tables, and, we continued the work for this release.</p>
<p>Dr.&nbsp;JooYoung Seo (<a href="https://github.com/jooyoungseo" target="_blank"><span class="citation" data-cites="jooyoungseo">@jooyoungseo</span>, on GitHub</a>), now a co-author of the package) led the work in improving the accessibility of structurally-complicated <strong>gt</strong> tables (those with multi-level headings, irregular headers, row groups, etc.). We adhered to the W3C WAI (<em>Web Accessibility Initiative</em>) guidance while working through this and now, with <code>v0.8.0</code>, screen readers can better describe <strong>gt</strong> tables having such complex structures.</p>
<h2 class="anchored">
In Conclusion
</h2>
<p>That was probably a long read but we hope it was an interesting one, full of things you can use! We care a lot about the <strong>gt</strong> package and so we’re relentless about improving it. Your feedback through GitHub Issues is incredibly valuable so always feel free to <a href="https://github.com/rstudio/gt/issues" target="_blank" rel="noopener noreferrer">file an issue</a>. Want to ask a question or discuss improvements before filing an issue? The <i><a href="https://github.com/rstudio/gt/discussions" target="_blank" rel="noopener noreferrer">Discussions page</a></i> in the <strong>gt</strong> repository is great for that. Want another way to keep in touch? Check out the fun new <a href="https://twitter.com/gt_package" target="_blank" rel="noopener noreferrer"><span class="citation" data-cites="gt_package">@gt_package</span> account on Twitter</a>!</p>


<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
  tabsets.forEach(function(tabset) {
    const tabby = new Tabby('#' + tabset.id);
  });
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>



</body></html>